experiment_name: bs-roformer_all
experiment_description: BS Roformer main experiment with all stems.
experiment_topic: Music-Source-Separation
experiment_tracker:
  name: MLFlowExperimentTracker
log_level: INFO
plugins:
  - hijos
output_folder: output

train:
  epochs: 20
  data:
    train:
      datasets:
        - name: MUSDB18HQ
          kwargs:
            targets: all
            subsets: [train]
            split: train
      dataloader:
        name: TorchDataLoader
        num_workers: 4
        batch_size: 2
        decoder:
          name: MusicSourceDecoder
        data_transforms:
          - name: RandomAudioChunk
            kwargs:
              chunk_length: 176400
              stereo: True
          - name: StereoToBatch
          - name: ToTorchTensor
        kwargs:
          drop_last: False
    eval:
      datasets:
        - name: MUSDB18HQ
          kwargs:
            targets: all
            subsets: [train]
            split: valid
      dataloader:
        name: TorchDataLoader
        num_workers: 1
        batch_size: 1
        decoder:
          name: MusicSourceDecoder
          kwargs:
            stereo_to_batch: False
        data_transforms:
          - name: AudioToChunks
            kwargs:
              chunk_length: 176400
              hop_length: 132300
              stereo: True
          - name: StereoToBatch
          - name: ToTorchTensor
  model:
    name: DemucsV2
    kwargs:
      sources: all
  criteria:
    name: TorchBsRoformerCriteria
    kwargs:
      num_stems: 4
      resolution_weight: 1.0
      stft_n_fft: 2048
      window_sizes: [4096, 2048, 1024, 512, 256]
      window_fn: hann
  optimizer:
    name: TorchSgdOptimizer
    kwargs:
      lr: 0.0005
      momentum: 0.9
      weight_decay: 2.0e-05
  looper:
    name: MusicSourceSeparationLooper
    kwargs:
      batch_size: 2
      compile: False
      use_gpu: True
  evaluator:
    name: MusicSourceSeparationEvaluator
    kwargs:
      chunk_length: 176400
      hop_length: 132300
      stereo: True
  metrics:
    - name: MusicSourceSeparationMetric
  saver:
    name: TorchModelSaver
evaluation:
  datasets:
    - name: MUSDB18HQ
      kwargs:
        targets: all
        subsets: [test]
  dataloader:
    name: TorchDataLoader
    num_workers: 4
    batch_size: 2
    decoder:
      name: MusicSourceDecoder
    data_transforms:
      - name: AudioToChunks
        kwargs:
          chunk_length: 176400
          hop_length: 132300
          stereo: True
      - name: StereoToBatch
      - name: ToTorchTensor
    kwargs:
      drop_last: False
  processor:
    name: TorchModelProcessor
    kwargs:
      use_gpu: True
  evaluator:
    name: MusicSourceSeparationEvaluator
    kwargs:
      chunk_length: 176400
      hop_length: 132300
      stereo: True
  metrics:
    - name: MusicSourceSeparationMetric
